\input{preamble}

\begin{document}
\input{Titelseite}
\chapter{Abstract}\label{abstract}

Business Case:
1) With the developed solution, doctors are getting an overview of the patient's blood pressure values. This makes them react more precisely to any special values. 
2) Since the patient is lead through a tutorial and the chatbot is 'controlling'/'checking' his measured blood pressure values, all measurements are taken more accurately. This improves the process of documentation.
3) With the service of sending a report via email every two weeks to the doctor. The doctor has always the current value and can interprete them faster. (now they are only getting a long list of all measured values of their patients which they have to interprete on their own and \begin{flushleft}
\end{flushleft}
4) Recommendation system of the nearest doctor helps the patient to directly go to his doctor 
Jack: 'Hey, i found these nearest doctors/specialists in your neighbourhood. Just select one of them and make an appointment with them. 

\chapter{Introduction}\label{introduction}

\section{Problem statement}

\section{Aim and scope of this work}
Aim of this scientific work is to develop a solution to document blood pressure in order to react preventively against heart disease.
To recommend an appropriate doctor in one's surrounding (approximately 5 kilometers of distance).
The application shall send every week/every two weeks a report (including a diagramm of all measured blood pressure values of the patient) to the doctor so that the doctor will be informed in real-time. In the diagrams/frontend, it is possible to select different scales, e.g. like the values of last week/last month/last year. 
At the beginning of using the Chatbot, the user is being led through a tutorial which shows him how to measure correctly his blood pressure. One instruction is for example not to drink coffee before measuring your blood pressure or to sit for at least 5 minutes.

\chapter{Fundamentals}\label{fundamentals}

\section{Reporting and Big Data}

\section{Software Architecture: Best Practices}

To describe the 'best practices' of software architecture, in this section the architecture of a blockchain \ac{p2p} network which is backed with a distributed ledger system (see figure \ref{example_software_architecture}) will be explained. As stated by Talukder et al.\footnote{cf.\autocite{talukder}}, this model is an appropriate solution for health applications because they support multiple stakeholders.

As a common problem in every big data project there are multiple data sources and systems which provide relevant information for the particular use case. For instance, these information can be handwritten human readable and human understandable medical notes. Some information are computer readable and human understandable and the third 'generation' of information describes computer readable and understandable algorithms.

In order to provide an effective treatment of any disease, all health related data of a person on a spatial and temporal basis from birth is needed. These data will be examined by a panel of experts to reach a consensus \ac{poc} and include all illness episodes, lab tests, pathological test results (which are outside the normal range), genomic data (to evaluate the genomic state of the individual), environmental and health events, lifestyle related data captured by \ac{iot}, therapeutic data and outcome analysis results.

According to Talukder et al.\footnote{cf.\autocite{talukder}}, there are three different types of mining: 

\begin{itemize}
\setlength\itemsep{-0.5em}
  \item \ac{mem}
  \item \ac{hsm} 
  \item payment (financial/coin) mining
\end{itemize}

As can be seen in figure \ref{example_software_architecture}, medical systems need many resources from which all relevant medical data iare loaded. As described by Talukder et al.\footnote{cf.\autocite{talukder}}, all medical data is processed by \ac{nlp} techniques, evidence based medicine as well as big data analytics (see figure \ref{example_software_architecture}).
In most health applications, patients' participation increases when they have access to their health and lab records. In the solution provided by Talukder et al. genomic tests and \ac{ncd} data are stored in the blockchain as a transaction.
Moreover, the blockchain technology is deployed in the cloud (cf. figure \ref{example_software_architecture} Ethereum).

\begin{figure}[htbp]
	\centering
	\includegraphics[width=1\textwidth]{images/example_software_architecture.png}
	\caption{Example software architecture cf.\autocite{talukder}}
	\label{example_software_architecture}
\end{figure}

What is more, there is a medical miner which validates every transaction, then translates all clinical notes into structured \ac{icd} or \ac{snowmed ct} codes. After that, all codes are stored into a smart contract. During that process, a medical expert validates whether current the onset matches any clinical pathway. 
Finally, medical experts discuss in a proper medical consensus if the data is useful for an accurate diagnosis and public health.

\subsection{\ac{soa} for big data applications in the cloud}
The state-of-the art architecture for any project is \ac{soa} and has many advantages, such as flexibility, agility, process orientation, time-to-market and innovation\footnote{cf.\autocite{zimmermann}}. What is more, \ac{soa} is convenient for cloud computing since it is ready for extended service models.
Figure \ref{esarc_example} shows the architecture 'ESARC', developed by Zimmermann et al.\footnote{cf.\autocite{zimmermann}}. It helps to cluster, classify, examine, compare, evaluate quality and optimize enterprise architectures. As depicted by figure \ref{esarc_example}, there is a link between enterprise and business information and design for supporting strategic initiatives. What is more, ESARC enables integration capacities for \ac{IT} management, software engineering, service and operations management as well as process improvement initiatives.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=1\textwidth]{images/esarc_cube.png}
	\caption{\ac{esarc} as an example for big data architecture cf.\autocite{zimmermann}}
	\label{esarc_example}
\end{figure}

As can be seen in figure \ref{esarc_example}, metamodels are used to define model elements in architectures. They relate architectural elements to ontologies which represent a common vocabulary for enterprise architectures.
Zimmermann et al. recommend that operations of tasks and entity services should not have any knowledge about their process or interactive usage context \footnote{cf.\autocite{zimmermann}}. Instead, task service operations should be independent from users and sessions and should only implement business functionality.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=1\textwidth]{images/esarc_business.png}
	\caption{\ac{esarc} business and information reference architecture cf.\autocite{zimmermann}}
	\label{vp_architecture}
\end{figure}

Figure \ref{vp_architecture} shows a more detailed view of 'ESARC', the procedural framework for architecture assessment processes and questionnaire design. On top of the graphic, with orange background, there are business vision, drivers, goals and objectives. To be more precuse, architecture governance has the goal to manage activities such as plan, define, enable, measure, control and sets rules for architecture complicance to internal and external standards. 

\paragraph{Actors in cloud computing}
According to Zimmermann et al., the main actors in cloud computing are cloud consumers, providers, auditors and broker \footnote{cf.\autocite{zimmermann}}. In general, all \ac{soa} services are cloud services and follow a reference architecture: 'Jericho-Security-focused Service-oriented Reference architecture for cloud computing'. Thereby, management perspectives from \ac{itil} and \ac{togaf} standards are integrated.

\section{Medical Documentation Apps}

\subsection{Review of smartphone apps to support self-management of hypertension}

\footnote{cf.\autocite{alessa}}



\subsection{Blood pressure monitoring in cardiovascular medicine and therapeutics}
As mentioned above, many medical applications are developed for self-monitoring\footnote{cf. p.4ff.\autocite{white_blood_2007}}. These bring many advantages and disadvantages. On the one hand, home blood pressure measurements are representative of natural environment and can show the response to antihypertensive medication. Furthermore, it is an easy and cost-effective way for obtaining a large number of readings. 
On the other hand, the measurement monitors might be too inaccurate and only a few devices have been subjected proper validation and failed tests.
White et al. mention three different monitors for home measurements: arm, wrist and finger monitors. Moreover, gender and age influence the measurement, e.g. women have lower blood pressure than men or age increases the blood pressure\footnote{cf. p.9ff.\autocite{white_blood_2007}}. 






\subsection{Social web and use cases for medical apps}
As stated by Lupton et al.\footnote{cf.\autocite{lupton_apps}} the current technical 'era' we are living in is the web 2.0 or social web. Social web includes sharing health and medical information with each other, e.g. patients and caregivers write about experiences and the individual health status. Often, the aim of these social webs is to control the health status by using online information and imaging.
Conforming to Lupton et al.\footnote{cf.\autocite{lupton_apps}}, in healthcare projects, big data can be used to generate knowledge about healthcare, health behaviours and disease patterns. Such applications can assist in calculating diagnosis, identifying risks, facilitating health, fitness self-tracking as well as patient self-care regimes.
As reported by a study which surveyed American doctors\footnote{cf.\autocite{lupton_apps}} medication interaction apps are the first most-used and diagnosis apps the second most used category of apps.
Moreover, pregnancy apps offer greater opportunities, such as that women can engage obsessive self-surveillance because of producing detailed data, such as heart rates, in real-time\footnote{cf.\autocite{lupton_apps}}. Pursuant to Lupton et al., the future potential of medical application lies in systems which enable lay people to access medical information (such as the electronic medical record) that was previously only available to healthcare practitioners or students.

In another article, Lupton et al. reported that the potential lies in automation of news or notifications which can be personalized or targeted so that doctors could contact patients directly to remind them to adhere to their tratment programs\footnote{cf.\autocite{lupton_mhealth}}.
A further example of medical applications are 'smart pillboxes' for patients suffering from diabetes\footnote{cf.\autocite{lupton_mhealth}}. 'Smart pillboxes' are wireless devices that remind patients to take their medication and alert a doctor if the patient had failed to conform to their medication regimen.
Continuing, \ac{m-health} technologies have a feedback, also called cybernetic mechanism in that they react with their users as opposed to passively provide information. To give an example, modern prosthesis or technological extensions of the body are a kind of cybernetic mechanism\footnote{cf.\autocite{lupton_mhealth}}. 
A big part of today's medical applications are surveillance systems in order to record and monitor cases of illnesses, such as obesity or infections\footnote{cf.\autocite{lupton_mhealth}}. These records might be useful to early detect epidemiological changes in the disease pattern. To give an example, 'individual medical encounters' which are conducted online enable doctors to flexibly practice personalized surveillance over each of their patients. At this point, another term occurs: 'surveillance knowledge' which refers to the digital data produced in the surveillance and can be useful for the individuate users.

\paragraph{Blockchain solution for accurate medical decisions}
As stated by Talukder et al. a significant amount of today's diagnosis in \ac{ncd} is erroneos or unwanted\footnote{cf.\autocite{talukder}}. The term \ac{ncd} implicates disease caused by an unheallthy lifestyle, the proper environment or genomic causes over a long time and come up with confusing signs and symptoms.
Talukder et al. mention 'P6'-Medicine which describes medicine using six adjectives starting with the letter 'p': medicine needs to be participatory, personalized, proactive, preventive, predictive, precision medicine.
As a requirement list for health data, Talukder et al. describe important features as follows: 

\begin{itemize}
\setlength\itemsep{-0.5em}
  \item secured (the anonymity, privacy, confidentiality of health data must be approved)
  \item systems which provide health data must have a zero down-time 
  \item the integrity of the health data must be ensured
  \item the systems must be ubiquitous which implies an unlimited availability
  \item machine understandable (all health data should be conform to international standards and should be able to be distributed over multiple systems)
  \item health systems should be resistant against fraudulent hacking
\end{itemize}

\section{Chatbots} 

\subsection{The potential of chatbots}
Modelling, profiling, analyzing and understanding users becomes increasingly important in many different indrustries and count as key to success in todays data driven world. 
The main advantage of chatbots is to provide a 24-hour customer service with personalized interaction and no waiting time\footnote{cf.\autocite{akhtar}}.
Akhtar et al. analyzed chat conversations between customers and the chatbot of a telecommunication company in order to find out the user's topics of interest and how to satisfy users. As described by Akhtar et al., the tests of the chatbot were splitted into different activities, such as text mining techniques (feedback comments), event sequence analysis, frequent term extraction, analysis of bigrams/trigrams. 
During data preprocessing, Akthar et al. used the following methods:
\begin{itemize}
\setlength\itemsep{-0.5em}
  \item[1.] corpus generation
  \item[2.] eliminating extra white space
  \item[3.] stopwords removal
  \item[4.] tokenizing
  \item[5.] stemming
  \item[6.] creating term-document matrices
\end{itemize}

The main challenges during the data analysis process are data availability, the access to further user information (e.g. contract details or age in order to generate an user model) and the distinction between different user types and different personality structures.

\paragraph{Question Answering Paradigms}
There are several types of conversations which can be designed by building a chatbot\footnote{cf.\autocite{akhtar}}. Generally, there can be distinguished between two different paradigms: information-retrieval based Question and Answering and knowledge-based Question and Answering. The first type describes the mechanism to define short texts as answers to a user's intent. On the opposite, the second type describes how to in natural language. The answers are stored into a full-related database and the conversation works simply with a rule-based method.
\paragraph{Types of dialog systems}
In general, dialog systems can be divided into two kinds of systems. On the one hand, there are task-oriented systems which are appropriate for short conversations and built for a certain purpose. On the other hand, there are non-task-oriented systems which are built for longer and more complex interactions with the purpose of imitating human conversations\footnote{cf.\autocite{akhtar}}.

\subsection{A deep learning question-answering specialized chatbot for medical students}
During their studies, medical students have to take an exam which is called \ac{osce} where they interact with a 'standardized' patient played by an actor who simulates the symptoms and intents of the patient\footnote{cf.\autocite{zini}}. The aim of this exam is to test and assess the students' abilities and social interaction and diagnosis skills.
Since in practice, there are not many actors who can play a patient's role, Zini et al. developed a virtual patient and chatbot system which works with \ac{nlp} techniques.

Figure \ref{vp_architecture} shows the architecture of the developed system to create a virtual patient. Zini et al. used a \ac{cnn} and \ac{lstm} network in order to learn domain specific word embeddings, sentence embedding and answer selection models.
The embeddings model which is outlined by a red rectangle in figure \ref{vp_architecture} is trained on a corpus of medical documents.
In Figure \ref{vp_architecture}, there is a \ac{nlp} engine outlined by a red rectangle. By using a supervised learning scheme to learn a mapping between question and answering pairs and judgement of correct match, this \ac{nlp} engine should correctly answer questions based on a script.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=1\textwidth]{images/vp_architecture.png}
	\caption{Virtual patient software architecture cf.\autocite{zini}}
	\label{vp_architecture}
\end{figure}

The aim of the developed system was to create a deep learning framework for answer selection in the medical domain and to create domain-specific word and sentence e,bedding models. Additionally, a question and answering corpus should be created for \ac{osce}s.

\paragraph{Question and Answering systems}
According to Zini et al. there are two types of question and answering systems\footnote{cf.\autocite{zini}}. First of all, there is open domain question and answering which uses very specific terminology. Secondly there are restricted domain question and answering systems which are broader in their scope. These are for example insurance-related deep learning question and answering systems which make use of two baseline models: \ac{bow} and \ac{ir} model. 


\chapter{Analysis and Development}

First of all, the developed chatbot includes information about blood pressure and was built to remind patients of their measurements. Secondly, based on the measured data, analysis can be done in order to react earlier to outliers. Thirdly, a generated report is sent to the doctor so that he can get more insights about the blood pressure values of his patients and improve the treatment.
One of the main challenges during development was the process of providing information about the disease to the patient. Is it possible to include information about different types of blood pressure into the automated conversation with a chatbot? Or does it overwhelm the conversation's use case? Is it useful to let the user ask questions like: 'What are the different types of hypertension? Am i a high-risk patient?' 
Or should these information be provided as a video or a simple web page with long articles to read? Might the patient or user be aborred after a while of talking to a chatbot who only knows answering his questions in the same way?
Of course, a chatbot can be developed more intelligent to never provide the same answer and to answer more precisely to a users' intent. But this requires a lot of training and testing. 
For that reason, in the first version of this chatbot, five simple intents and dialogs have been designed and implemented with the focus of the instructions to measure correctly and regularly. 
In a second or third version, it is possible to focus more on the improvement of providing information about the disease (by not doing this in the style of question and answering).

\section{Experimental set-up}

\subsection{Software architecture}

\subsection{Components}
\begin{figure}[htbp]
	\centering
	\includegraphics[width=1\textwidth]{images/components.png}
	\caption{Component diagram of developed solution}
	\label{ncbi_query}
\end{figure}

\paragraph{Kaggle Dataset}
%https://www.kaggle.com/mkachuee/BloodPressureDataset
\paragraph{Development of Watson Assistant Dialog}

\subparagraph{Intent model}

The chatbot was built according to the description of "Deutsche Hochdruckliga", a german organization for patients with hypertonia \footnote{cf.\autocite{hochdruckliga}}.
To better understand the users and patients a basic intent model with four intents was developed. 
The four intents include 

\begin{center}
\begin{tabular}{ |c|c| } 
\hline
Intent & User input  \\
\hline

\multirow{4}{4em}\\
Definition of hypertonia  & What is hypertonia?  \\ 
Curses of hypertonia & What are the implications or curses of hypertonia? \\ 
Blood pressure measurement &  I am measuring my blood pressure.\\ 
Measurement tutorial & How should i measure my blood pressure? \\ 
\hline
\end{tabular}
\end{center}


These five intents were used to define and develop four typical dialogs, displayed in figure \ref{dialog_diagram_01}, \ref{dialog_diagram_02}, \ref{dialog_diagram_03} and \ref{dialog_diagram_04}.

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/01_Hypertonie_Definition.png}
	\caption{Dialog diagram: definition of hypertonia}
	\label{dialog_diagram_01}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/02_Hypertonie_Ursachen.png}
	\caption{Dialog diagram: curses of hypertonia}
	\label{dialog_diagram_02}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/03_blutdruck_messung.png}
	\caption{Dialog diagram: blood pressure measurement}
	\label{dialog_diagram_03}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/04_tutorial_messung.png}
	\caption{Dialog diagram: measurement tutorial}
	\label{dialog_diagram_04}
\end{figure}


\subparagraph{Watson Assistant implementation}

In the following, the implemented dialog as well as all entities and intents are described. They have been developed according to the Watson Assistant documentation \footnote{cf.\autocite{wa_docu}}.

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/WA_dialog.png}
	\caption{Watson Assistant dialog}
	\label{wa_dialog}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/WA_intents.png}
	\caption{Watson Assistant intents}
	\label{wa_intents}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=1\textwidth]{images/WA_entities.png}
	\caption{Watson Assistant entitities}
	\label{wa_entities}
\end{figure}


\paragraph{Setup of MongoDB and basic AngularJS Frontend}

\paragraph{Connect Watson Assistant to Frontend and MongoDB}

To be able to connect to the Watson Assistant instance on IBM cloud, the API Version 2.0 had to be called. First of all, the current sessionId has to be requested to be able to interact with Watson Assistant. After that, a simple get request is executed to let the chatbot start the conversation. Everytime, the user sends a message to Watson Assistant, a post request is sent to the API and the response is the best fitting answer (with the highest confidence value) from Watson, which is calculated \footnote{cf.\autocite{wa_api_v2}}.

\paragraph{Data visualization: Development of a Python Script to show all measured values}

\paragraph{Development of recommendation of nearest doctors to patient}
outlook: maybe in future to connect to the doctors' calendar to directly make an appointment through the chatbot

\paragraph{Development of email service to send reports every two weeks to the doctor}

Another challenge was the way to automatically ask the user for his measured data. A 'usual' chatbot only helps in certain situations including precise user intents, e.g. the question 'When should i measure my blood pressure?'. But they are not constructed to ping a user every five hours or once a day in order to retrieve his measured data, analyze these and send them to a doctor. 
In order to face this problem or use case, a routine including a timer had to be implemented.

\section{Problem solving}
\subsection{Tests}
\subsection{Dataset}
\section{Results}

\chapter{Conclusion and Outlook }
\section{Conclusion}

\section{Outlook}
Is a chatbot an appropriate solution for recording and reminding patients to measure their blood pressure ? 
In practice, most chatbots are created to solve and help multiple intents of their users and not to only 'retrieve' information.
On the one hand, the retrieved information can be used to run several analysis and to find out trends in the data. But on the other hand, the developed solution  supports users to never forget to measure and doctors to better understand trends in the measured data.
During development and research, there came up another issue: To inform patients precisely about their illness. Most patients go to doctors and describe their symptoms, the doctor makes some diagnosis and provides them some medication. But in most cases, doctors do not have enough time to answer all the questions of their patients. For that reason it might be useful to provide a 24/7 service for patients with chronic disease to both record their symptoms and measurements and to answer all their questions.


connection frontend (angularjs webpage) to mongodb through socket.io connection.
Connection between Watson Assistant and Frontend through mongodb and via socket.io connection.


% ncbi query for all genomes
%\begin{figure}[htbp]
%	\centering
	%\includegraphics[width=1\textwidth]{Image/ncbi_all_result.png}
%	\caption{\ac{ncbi} query to find all \ac{all} related gene sequences}
%	\label{ncbi_query}
%\end{figure}


\chapter{Abbreviations}
\input{Abkuerzung}

\printbibliography[heading=bibintoc]

\chapter{Appendix A}\label{appendix a}
\input{Anhang}
\chapter{Appendix B}\label{appendix b}
%\includepdf[pages=-]{lda_all_genomes_v04.pdf}

\end{document}
